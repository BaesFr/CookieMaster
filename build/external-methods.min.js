var CME={},CMEO={};CME.cacheStore={},CME.informations={items:[],bonus:[],bci:[],roi:[],timeLeft:[]},CME.milkPotentials={"Kitten helpers":.05,"Kitten workers":.1,"Kitten engineers":.2,"Kitten overseers":.2,"Santa's milk and cookies":.05},CME.getAchievementWorth=function(a,b,c,d){var e,f,g,h=0,i=0,j=this.getHeavenlyMultiplier(),k=Game.milkProgress;return"undefined"==typeof d&&(d=0),0!==d&&(j=d),Game.UpgradesById.forEach(function(a){a.bought&&a.matches("Cookie production multiplier <b>+")&&(j+=a.getDescribedInteger()),a.id===b&&a&&!a.bought&&a.matches("Cookie production multiplier <b>+")&&(i+=a.getDescribedInteger())}),e=this.applyMilkPotential(j,k),f=this.computeNewIncome(c,e),g=Game.UpgradesById[b].name,j+=i,k+=.04*a,e=this.applyMilkPotential(j,k,g),h=this.computeNewIncome(c,e),a=this.getUnlockedIncomeAchievements(h),a>0&&(k+=.04*a,e=this.applyMilkPotential(j,k,g),h=this.computeNewIncome(c,e)),0===d&&(h-=f),Game.Has("Elder Covenant")&&(h*=.95),h},CME.computeNewIncome=function(a,b){return(Game.cookiesPs+a)/Game.globalCpsMult*(b/100)*this.getFrenzyMultiplier()},CME.getUnlockedIncomeAchievements=function(a){var b=0;return Game.frenzyPower?0:(Game.AchievementsById.forEach(function(c){!c.won&&c.matches(" per second.")&&a>=c.getDescribedInteger()&&b++}),b)},CME.applyMilkPotential=function(a,b,c){var d,e,f=[];"undefined"==typeof b&&(b=Game.milkProgress);for(d in this.milkPotentials)e=Game.Has(d)||d===c,f.push(e*this.milkPotentials[d]);return a+=100,f.forEach(function(c){a*=1+c*b}),a},CME.hasAchievement=function(a){var b=Game.Achievements[a];return b?b.won:!1},CME.hasntAchievement=function(a){return!this.hasAchievement(a)},CME.buildingAmount=function(a){var b={Cursor:{0:"Click",1:"Double-click",49:"Mouse wheel",99:"Of Mice and Men",199:"The Digital"},Grandma:{0:"Grandma's Cookies",49:"Sloppy kisses",99:"Retirement home",149:"Friend of the ancients",199:"Ruler of the ancients"},Farm:{0:"My first farm",49:"Reap what you sow",99:"Farm ill"},Factory:{0:"Production chain",49:"Industrial revolution",99:"Global warming"},Mine:{0:"You know the drill",49:"Excavation site",99:"Hollow the planet"},Shipment:{0:"Expedition",49:"Galactic highway",99:"Far far away"},"Alchemy lab":{0:"Transmutation",49:"Transmogrification",99:"Gold member"},Portal:{0:"A whole new world",49:"Now you're thinking",99:"Dimensional shift"},"Time machine":{0:"Time warp",49:"Alternate timeline",99:"Rewriting history"},"Antimatter condenser":{0:"Antibatter",49:"Quirky quarks",99:"It does matter!"},Prism:{0:"Lone photon",49:"Dazzling glimmer",99:"Blinding flash",149:"Unending glow"}},c=b[a.name][a.amount];return c?this.hasntAchievement(c):!1},CME.baseTen=function(a){var b,c,d=[],e=[];if(this.hasAchievement("Base 10"))return!1;for(Game.ObjectsById.forEach(function(a){d.push(a.name),e.push(a.amount)}),d.forEach(function(b,c){b===a&&e[c]++}),b=10*e.length,c=0;c<e.length;c++){if(e[c]<b||e[c]>b)return!1;b-=10}return!0},CME.mathematician=function(a){var b,c,d=[],e=[];if(this.hasAchievement("Mathematician"))return!1;for(Game.ObjectsById.forEach(function(a){d.push(a.name),e.push(a.amount)}),d.forEach(function(b,c){b===a&&e[c]++}),b=128,c=0;c<e.length;c++)if(c>2&&(b/=2),e[c]<b)return!1;return!0},CME.oneWithEverything=function(a){return this.hasAchievement("One with everything")?!1:this.checkBuildingUnifiesAmounts(0,a)},CME.centennial=function(a){return this.hasAchievement("Centennial")?!1:this.checkBuildingUnifiesAmounts(99,a)},CME.checkBuildingUnifiesAmounts=function(a,b){var c=[];return Game.ObjectsById.forEach(function(b){b.amount===a&&c.push(b.name)}),1===c.length&&c[0]===b?!0:!1},CME.getBestValue=function(a){return[Math[a].apply(Math,this.informations.bci),Math[a].apply(Math,this.informations.timeLeft),Math[a].apply(Math,this.informations.roi)]},CME.setBuildingInformations=function(a,b){this.informations.items[a]=b.items,this.informations.bonus[a]=b.bonus,this.informations.bci[a]=b.bci,this.informations.roi[a]=b.roi,this.informations.timeLeft[a]=b.timeLeft},CME.updateBuildingsInformations=function(){Game.ObjectsById.forEach(function(a,b){var c='(<span class="text-blue">'+a.amount+"</span>)";CME.setBuildingInformations(b,{items:a.name.split(" ")[0]+" "+c,bonus:a.getWorth(!0),bci:a.getBaseCostPerIncome(!0),roi:a.getReturnInvestment(),timeLeft:a.getTimeLeft()})})},CME.getBuildingWorth=function(a){var b=Game.globalCpsMult,c=a.storedCps*b,d=0;switch(d+=this.buildingAmount(a),99===Game.BuildingsOwned&&(d+=this.hasntAchievement("Builder")),399===Game.BuildingsOwned&&(d+=this.hasntAchievement("Architect")),799===Game.BuildingsOwned&&(d+=this.hasntAchievement("Engineer")),this.oneWithEverything(a.name)&&d++,this.mathematician(a.name)&&d++,this.baseTen(a.name)&&d++,this.centennial(a.name)&&d++,a.name){case"Grandma":case"Farm":case"Factory":case"Mine":case"Shipment":case"Alchemy lab":case"Portal":case"Time machine":case"Antimatter condenser":case"Grandma":c+=this.getTotalCursorModifiers()*b;break;case"Grandma":c+=this.getTotalGrandmaModifiers(a.amount)*b;break;case"Portal":c+=this.getTotalPortalModifiers()*b}return c+this.callCached("getAchievementWorth",[d,0,c])},CME.getTotalCursorModifiers=function(){var a=0;return Game.UpgradesById.forEach(function(b){if(b.bought&&b.matches("The mouse and cursors gain")){var c=31;b.matches(" another ")&&(c+=8),a+=1*b.desc.substr(c,b.desc.indexOf("<",c)-c)}}),a*Game.ObjectsById[0].amount},CME.getTotalGrandmaModifiers=function(a){var b=.5,c=0,d=1;return Game.UpgradesById.forEach(function(e){e.bought&&"Forwards from grandma"===e.name?b+=.3:e.bought&&e.matches("Grandmas are <b>twice</b>.")?d*=2:e.bought&&e.matches("Grandmas are <b>4 times</b> as efficient.")?d*=4:e.bought&&e.matches("for every 50 grandmas")?c+=.02*(a+1)*(a+1)-.02*a*a:e.bought&&e.matches("for every 20 portals")&&(c+=.05*Game.ObjectsById[7].amount)}),b*d+c*d},CME.getTotalPortalModifiers=function(){var a=0,b=1;return Game.UpgradesById.forEach(function(c){c.bought&&c.matches("Grandmas are <b>twice</b> as efficient.")?b*=2:c.bought&&c.matches("Grandmas are <b>4 times</b> as efficient.")?b*=4:c.bought&&c.matches("for every 20 portals")&&(a+=.05*Game.ObjectsById[1].amount)}),a*b},CME.getFrenzyMultiplier=function(){return Game.frenzy>0?Game.frenzyPower:1},CME.getLuckyTreshold=function(a,b){var c=b||Game.cookiesPs;return c/=this.getFrenzyMultiplier(),"frenzy"===a&&(c*=7),Math.round(10*(60*c*20+13))},CME.getHeavenlyMultiplier=function(){var a,b=2*Game.prestige["Heavenly chips"],c=0,d={"Heavenly chip secret":.05,"Heavenly cookie stand":.2,"Heavenly bakery":.25,"Heavenly confectionery":.25,"Heavenly key":.25};for(a in d)Game.Has(a)&&(c+=d[a]);return b*c},CME.estimatePledgeCost=function(a){var b,c=Game.Upgrades["Elder Pledge"],d=Game.Has("Sacrificial rolling pins")?60:30,e=a/d,f=c.getPrice(),g=0;for(b=0;e>b;b++)g+=f,f=Math.pow(8,Math.min(Game.pledges+2,14)),f*=Game.Has("Toy workshop")?.95:1,f*=Game.Has("Santa's dominion")?1:.98;return CM.largeNumFormat(g)},CME.estimateCovenantCost=function(a){var b=60*Game.cookiesPs*a;return CM.largeNumFormat(b-.95*b)},CME.getUpgradeWorth=function(a){var b,c=0,d=0,e=Game.globalCpsMult,f=["Cursors","Grandmas","Farms","Factories","Mines","Shipments","Alchemy labs","Portals","Time machines","Antimatter condensers"];return f.forEach(function(b,d){a.matches(b+" are <b>")&&(c=CME.getBuildingUpgradeOutcome(d))}),b=[{building:"Cursors",modifier:.1},{building:"Grandmas",modifier:.3},{building:"Farms",modifier:.5},{building:"Factories",modifier:4},{building:"Mines",modifier:10},{building:"Shipments",modifier:30},{building:"Alchemy labs",modifier:100},{building:"Portals",modifier:1666},{building:"Time machines",modifier:9876},{building:"Antimatter condensers",modifier:99999}],b.forEach(function(b,d){a.matches(b.building+" gain <b>")&&(c=CME.getMultiplierOutcome(b.building,b.modifier,d))}),a.matches("Grandmas are <b>twice</b>")?d+=this.lgt(a):a.matches("for each non-cursor object")?c=this.getNonObjectsGainOutcome(a):a.matches("for every 50 grandmas")?c=this.getGrandmasPerGrandmaOutcome():a.matches("for every 20 portals")?c=this.getGrandmasPerPortalOutcome():a.matches("potential of your heavenly")&&(c=this.getHeavenlyUpgradeOutcome(d,a)/e,"Heavenly key"===a.name&&(d+=this.hasntAchievement("Wholesome"))),"Elder Covenant"===a.name?Game.cookiesPs*-.05:"Revoke Elder Covenant"===a.name?Game.cookiesPs/e*1.05*e-Game.cookiesPs:(19===Game.UpgradesOwned&&(d+=this.hasntAchievement("Enhancer")),49===Game.UpgradesOwned&&(d+=this.hasntAchievement("Augmenter")),99===Game.UpgradesOwned&&(d+=this.hasntAchievement("Upgrader")),c*e+this.callCached("getAchievementWorth",[d,a.id,c]))},CME.getBuildingUpgradeOutcome=function(a){return Game.ObjectsById[a].storedTotalCps},CME.getMultiplierOutcome=function(a,b,c){var d=1;return Game.UpgradesById.forEach(function(b){b.bought&&b.matches(a+" are <b>twice</b>")&&(d=2*d),b.bought&&b.matches(a+" are <b>4 times</b>")&&(d=4*d)}),Game.ObjectsById[c].amount*d*b},CME.getHeavenlyUpgradeOutcome=function(a,b){var c=2*Game.prestige["Heavenly chips"]*(b.getDescribedInteger()/100);return this.callCached("getAchievementWorth",[a,b.id,0,c])-Game.cookiesPs},CME.getGrandmasPerPortalOutcome=function(){var a=1;return Game.UpgradesById.forEach(function(b){b.bought&&b.matches("Grandmas are <b>twice</b>.")&&(a=2*a),b.bought&&b.matches("Grandmas are <b>4 times</b>")&&(a=4*a)}),.05*Game.ObjectsById[7].amount*a*Game.ObjectsById[1].amount},CME.getGrandmasPerGrandmaOutcome=function(){var a=1;return Game.UpgradesById.forEach(function(b){b.bought&&b.matches("Grandmas are <b>twice</b>")&&(a=2*a),b.bought&&b.matches("Grandmas are <b>4 times</b>")&&(a=4*a)}),.02*Game.ObjectsById[1].amount*a*Game.ObjectsById[1].amount},CME.lgt=function(a){var b=[];return this.hasAchievement("Elder Pact")||-1===a.name.indexOf(" grandmas")?!1:(Game.UpgradesById.forEach(function(a,c){a.bought||-1===a.name.indexOf(" grandmas ")||b.push(c)}),1===b.length&&b[0]===a.id)},CME.getNonObjectsGainOutcome=function(a){return a.getDescribedInteger()*(Game.BuildingsOwned-Game.ObjectsById[0].amount)*Game.ObjectsById[0].amount},CME.getFourTimesEfficientOutcome=function(a){return 3*Game.ObjectsById[a].storedTotalCps},CME.cache=function(a,b,c){var d,e=[Game.UpgradesOwned,Game.BuildingsOwned,Game.globalCpsMult].join("-");return"undefined"==typeof this.cacheStore[e]&&(this.refreshCache(),this.cacheStore[e]={}),c=c||[],a=this.computeSalts(a,c),"undefined"!=typeof this.cacheStore[e][a]?this.cacheStore[e][a]:(d=b.apply(this,c),this.cacheStore[e][a]=d,d)},CME.callCached=function(a,b,c){return c=c||[],c.push(a),this.cache(c,this[a],b)},CME.refreshCache=function(){this.cacheStore={}},CME.computeSalts=function(a,b){a=a.concat(b);for(var c=0;c<a.length;c++)"undefined"!=typeof a[c].identifier&&(a[c]=a[c].identifier());return a.join("-")},CME.roundDecimal=function(a){return Math.round(100*a)/100},CME.secondsLeft=function(a){var b=Game.cookies-a.getPrice();return 0===Game.cookiesPs||b>0?0:Math.round(Math.abs(b)/CM.effectiveCps())},CME.getTimeToCookies=function(a){return CM.formatTime(a/CM.effectiveCps(),!0)},CMEO.identifier=function(){return"cookie-master__"+this.getType()+"--"+this.id},CMEO.matches=function(a){return this.desc?-1!==this.desc.toLowerCase().indexOf(a.toLowerCase()):!1},CMEO.getDescribedInteger=function(){return this.matches("<b>")?1*this.desc.match(/<b>\+?([\.0-9]+)%?/)[1].replace(/[%,]/g,""):void 0},CMEO.getTypeOf=function(){return this instanceof Game.Upgrade?"upgrade":"object"},CMEO.getWorthOf=function(a){var b="upgrade"===this.getType()?CME.callCached("getUpgradeWorth",[this]):CME.callCached("getBuildingWorth",[this]);return a?CME.roundDecimal(b):b},CMEO.getBaseCostPerIncome=function(a){var b=this.getWorth(),c=CME.roundDecimal(this.getPrice()/b);return 0>b?1/0:a?CME.roundDecimal(c):c},CMEO.getReturnInvestment=function(){var a=this.getWorth();return this.price*(a+Game.cookiesPs)/a},CMEO.getTimeLeft=function(){return CME.secondsLeft(this)},CMEO.getComparativeInfos=function(){return[this.getBaseCostPerIncome(),this.getTimeLeft(),this.getReturnInvestment()]},CMEO.getColors=function(){return CME.computeColorCoding(this.getComparativeInfos())},CME.getThresholdAlerts=function(a){var b=a.getPrice(),c=Game.cookiesPs+a.getWorth(),d=[0,0,0],e=[this.getLuckyTreshold(!1,c),this.getLuckyTreshold("frenzy",c),CM.requiredChainTier("bank","this",CM.maxChainReward())];return Game.cookies-b<e[0]&&(d[0]=e[0]-(Game.cookies-b)),Game.cookies-b<e[1]&&(d[1]=e[1]-(Game.cookies-b)),Game.cookies-b<e[2]&&(d[2]=e[2]-(Game.cookies-b)),d},CME.computeColorCoding=function(a){var b,c=["yellow","yellow","yellow"],d=this.getBestValue("max"),e=this.getBestValue("min");for(b=0;b<a.length;b++)1/0===a[b]?c[b]="greyLight":a[b]<e[b]?c[b]="blue":a[b]===e[b]?c[b]="green":a[b]===d[b]?c[b]="red":a[b]>d[b]?c[b]="purple":d[b]-a[b]<a[b]-e[b]&&(c[b]="orange");return a[2]===e[2]&&(c[2]="cyan"),c},CME.isInStore=function(a){return-1!==Game.UpgradesInStore.indexOf(a)};